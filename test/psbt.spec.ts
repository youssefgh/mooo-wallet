import * as bitcoinjs from 'bitcoinjs-lib';
import * as ecc from 'tiny-secp256k1';
import { Mnemonic } from '../src/app/core/bitcoinjs/mnemonic';
import { Psbt } from '../src/app/core/bitcoinjs/psbt';

describe('Psbt', () => {

  it(`should not sign when mnemonic is different`, () => {
    const text = 'cHNidP8BAHECAAAAAbftTaU4oibD/kW4UuqG6VdPDn+AAddxfr1ORxs1In86AQAAAAD9////AqCGAQAAAAAAFgAU5oWAo35pGRpBve4vZuSf/RJ1l2usuIYAAAAAABYAFLob/Ay3/Fh09j461ZNq7kr9xDGDFD8lAAABAR/fP4gAAAAAABYAFMGTrvcmAlKD1XeIBJ2VhWvvXSIVAQD9FAICAAAAAAEDhx39Hm/Q+IEzeHzEIQR8hBFoWzQ7BgBNoq874UoXMI8AAAAAAP////+HEku25SJEM3C2XreROh/mAz9b3TV8pcEqT+zkrmDmbQAAAAAA/////yVr+qF09nHcVW8ARJTTnS0ZAzqBnSZjMBkGfl8wTKWOAQAAAAD/////AkBCDwAAAAAAIlEgD6fPGREBB8wuXHhOWjo7IPSS18oTbjir40WX7rJkP/vfP4gAAAAAABYAFMGTrvcmAlKD1XeIBJ2VhWvvXSIVAkgwRQIhAMsS8DNQhm1nKNVdL7owODpSrzeT2g08Jle8DzuMXEeBAiAHWR4cgpVAb+iHfMC9mpANFSNbjX0AjEdzZoC3kdygFAEhA2lmae3eHVT5DXJO+hSE/TOpI+5+D8qh1leRl5bL3O11AkcwRAIgdBOmAZuhELYvPJnbkRiCzGeYFgQ/MfoLNrsSVaSKeykCIDKQy+g6SeDBs6kJyXfVFlwXBFEpNcXmuA3lx6gDYTJUASECowQJtYhfXkPjBAHvC75lkFV5iSySYhty0FuAZMKtNksCSDBFAiEAua9he0HPwnRRYirYosDYyOjHYjcaEutLHeC0OYyk8S4CIChY/8DJ5nrodq3v6uLVnz/REsvPflTJ0ZFCdAtZWHy0ASECTmFJCY3OFzc/ljonlf5/eZVJQ5bfpheqaBJKdcswCnsAAAAAIgYDSAQOnCYCKWLs9oZ+yc+h54A6wej0RJ91nJU5HAuRAV0Yvc6JwFQAAIABAACAAAAAgAEAAAAKAAAAAAAiAgJgB8m777kJYRcdc9oPiSIpke67GbC33a2h9dntzSO/vhi9zonAVAAAgAEAAIAAAACAAQAAAAgAAAAA';
    const mnemonic = Mnemonic.new(256);
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.psbtBase64).toEqual(undefined);
    expect(signResult.signedTransaction).toEqual(undefined);
  });

  it(`should sign bip84`, () => {
    const text = 'cHNidP8BAHECAAAAAbftTaU4oibD/kW4UuqG6VdPDn+AAddxfr1ORxs1In86AQAAAAD9////AqCGAQAAAAAAFgAU5oWAo35pGRpBve4vZuSf/RJ1l2usuIYAAAAAABYAFLob/Ay3/Fh09j461ZNq7kr9xDGDFD8lAAABAR/fP4gAAAAAABYAFMGTrvcmAlKD1XeIBJ2VhWvvXSIVAQD9FAICAAAAAAEDhx39Hm/Q+IEzeHzEIQR8hBFoWzQ7BgBNoq874UoXMI8AAAAAAP////+HEku25SJEM3C2XreROh/mAz9b3TV8pcEqT+zkrmDmbQAAAAAA/////yVr+qF09nHcVW8ARJTTnS0ZAzqBnSZjMBkGfl8wTKWOAQAAAAD/////AkBCDwAAAAAAIlEgD6fPGREBB8wuXHhOWjo7IPSS18oTbjir40WX7rJkP/vfP4gAAAAAABYAFMGTrvcmAlKD1XeIBJ2VhWvvXSIVAkgwRQIhAMsS8DNQhm1nKNVdL7owODpSrzeT2g08Jle8DzuMXEeBAiAHWR4cgpVAb+iHfMC9mpANFSNbjX0AjEdzZoC3kdygFAEhA2lmae3eHVT5DXJO+hSE/TOpI+5+D8qh1leRl5bL3O11AkcwRAIgdBOmAZuhELYvPJnbkRiCzGeYFgQ/MfoLNrsSVaSKeykCIDKQy+g6SeDBs6kJyXfVFlwXBFEpNcXmuA3lx6gDYTJUASECowQJtYhfXkPjBAHvC75lkFV5iSySYhty0FuAZMKtNksCSDBFAiEAua9he0HPwnRRYirYosDYyOjHYjcaEutLHeC0OYyk8S4CIChY/8DJ5nrodq3v6uLVnz/REsvPflTJ0ZFCdAtZWHy0ASECTmFJCY3OFzc/ljonlf5/eZVJQ5bfpheqaBJKdcswCnsAAAAAIgYDSAQOnCYCKWLs9oZ+yc+h54A6wej0RJ91nJU5HAuRAV0Yvc6JwFQAAIABAACAAAAAgAEAAAAKAAAAAAAiAgJgB8m777kJYRcdc9oPiSIpke67GbC33a2h9dntzSO/vhi9zonAVAAAgAEAAIAAAACAAQAAAAgAAAAA';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.signedTransaction).toEqual('02000000000101b7ed4da538a226c3fe45b852ea86e9574f0e7f8001d7717ebd4e471b35227f3a0100000000fdffffff02a086010000000000160014e68580a37e69191a41bdee2f66e49ffd1275976bacb8860000000000160014ba1bfc0cb7fc5874f63e3ad5936aee4afdc4318302483045022100cf27108fc4ad8743d74be54a04323b494f66374fea1540a94d091b9116a2918c02207eccab5daa7d456a795893e97fcb12c8ce1c405415f77af4afc53b372e57f8fa01210348040e9c26022962ecf6867ec9cfa1e7803ac1e8f4449f759c95391c0b91015d143f2500');
  });

  it(`should sign bip49`, () => {
    const text = 'cHNidP8BAHMCAAAAASVr+qF09nHcVW8ARJTTnS0ZAzqBnSZjMBkGfl8wTKWOAAAAAAD9////AtiFAQAAAAAAF6kUtnpJCJE5NQcm9kh8eaKq58pMplCHoIYBAAAAAAAXqRRnrgjC4pSlWUPXS8rWaXtm2Lxkf4cUPyUAAAEBIEANAwAAAAAAF6kUsyOJgC2az08Qlf4y5/qZgyWkmtyHAQDfAgAAAAABAQatW1ABGPWd1+SXnfjGsPLI2amGiyXOd2nQ1+3fJpWYAQAAAAD9////AkANAwAAAAAAF6kUsyOJgC2az08Qlf4y5/qZgyWkmtyH5NydAAAAAAAWABQmX8Ndbn5vUp5A83OmyWM+yvVd/QJHMEQCIAFN8jJafk/e028lTYFJ83ae8htx0C5kpSnAKJIvXsviAiA0PJPAOMoH6qzChT7OaJfhCg6is5MgfZ1Otfp/AunEfQEhAqG5afjYiXcTEeQvTaMrzg0biVO7iNpCaVbH8JuHo35yQjElAAEEFgAUnOkOGNUO8SMaoic6prWPyOqBo5wiBgKOK+8YrE9ria5xh/fokvDedZbj8nRDW4WBoWal9JWtGRi9zonAMQAAgAEAAIAAAACAAAAAAAAAAAAAAQAWABSj4FgqT3CQOQxWadTgITMlS45CcSICAyJ8jjwxBBgBTyESB63eate2Vzrp7DEDNIxN2HmKA32wGL3OicAxAACAAQAAgAAAAIABAAAAAAAAAAABABYAFO9wM4WfbqzViD0V5C9dLUq5OyqBIgICCok5y4p2NSM8CDdMClV7Kw+zTvwW+Y2hfXcRHTMLnh0Yvc6JwDEAAIABAACAAAAAgAAAAAABAAAAAA==';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.signedTransaction).toEqual('02000000000101256bfaa174f671dc556f004494d39d2d19033a819d26633019067e5f304ca58e00000000171600149ce90e18d50ef1231aa2273aa6b58fc8ea81a39cfdffffff02d88501000000000017a914b67a49089139350726f6487c79a2aae7ca4ca65087a08601000000000017a91467ae08c2e294a55943d74bcad6697b66d8bc647f87024830450221009bce44c8ddfdb4cc1d5fffee78f5b2de97184402831d4d4d082181e96ad5f80702207ac65c9c0339641bdfb6d1fcd898e559a8efc83d134f8e33942ea47272d25c530121028e2bef18ac4f6b89ae7187f7e892f0de7596e3f274435b8581a166a5f495ad19143f2500');
  });

  it(`should sign bip86`, () => {
    bitcoinjs.initEccLib(ecc);
    const text = 'cHNidP8BAIkCAAAAAZpnS06xz7jtACwzfACEQRaYsJWwl53LB/ZTTIalfzTLAAAAAAD9////AiEPBAAAAAAAIlEgvO+xQxmtwf37xm5YFMKPqNvz394Mf3fPm7KRM47Fq84gTgAAAAAAACIAIDSMgu49KdSI5X1Svx0JfOgPEjah4IjjAUWdFD5W06ItAAAAAE8BBDWHzwNG7QLGgAAAAIp3dctqaWxIpONEZ6C8RMBdk8g9IDuCE6LgpRwrUE2RAhI0At/gdsARa0g0oh4UNjcInIGiKB93e9efr44AAIhvEL3OicBWAACAAQAAgAAAAIAAAQCJAgAAAAHQwjuqT8URSftuAZgq50jVM4ZPx9TmALc6l0iSfDce7AEAAAAArAMAAAJJaQQAAAAAACJRIHOTwBcauE/nhnbiTELZh8fJlunoeBVte180oVNKRXdQECcAAAAAAAAiACAop30EU/1IyyFPJJAfQJjqCKULsxw4mcZ0xQuQITWn6QAAAAABAStJaQQAAAAAACJRIHOTwBcauE/nhnbiTELZh8fJlunoeBVte180oVNKRXdQAQMEAAAAACEWZpnkzT4Dif0ch7r0YChTxlzKjjP1snEHEXLwAtM0M+kZAL3OicBWAACAAQAAgAAAAIABAAAABAAAAAEXIGaZ5M0+A4n9HIe69GAoU8Zcyo4z9bJxBxFy8ALTNDPpACEH4uuL6RfGaoaLWzJjNa3L8OZp1L/Og3Xf4eq7hU+fpKcZAL3OicBWAACAAQAAgAAAAIABAAAABQAAAAEFIOLri+kXxmqGi1syYzWty/DmadS/zoN13+Hqu4VPn6SnAAA=';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.signedTransaction).toEqual('020000000001019a674b4eb1cfb8ed002c337c0084411698b095b0979dcb07f6534c86a57f34cb0000000000fdffffff02210f040000000000225120bcefb14319adc1fdfbc66e5814c28fa8dbf3dfde0c7f77cf9bb291338ec5abce204e000000000000220020348c82ee3d29d488e57d52bf1d097ce80f1236a1e088e301459d143e56d3a22d01408e81d1393164746f0ed5e21b130e752500860cec6d4d018e0fe165b592ccea02aed40eecc173ce6185ff0398cb8f69c4e700654bc6f01e604936a39dbb47823c00000000');
  });

  it(`should sign bip48`, () => {
    const text = 'cHNidP8BAIkCAAAAAZpnS06xz7jtACwzfACEQRaYsJWwl53LB/ZTTIalfzTLAQAAAAD9////AnAXAAAAAAAAIlEgPakx8TTOJxf/OEiMDByx5NgDYqgniKptYCWqlQ00vLTXDgAAAAAAACIAINY1farI+ysIpgLTqzN6xyDGcvStlP9vvH9/HEMOXiUC2LclAE8BBDWHzwSws+U1gAAAAhztXxAU+ixMlx/4G6PCe48OEsd5kBVN3i8OWTP8EzOYAn098S+ppFDGsktxQpoEEyOJrEdx4SO7i+3TGAWJ4ukbFL3OicAwAACAAQAAgAAAAIACAACATwEENYfPBBhO+xGAAAACk7k2tWbGW4D6vuor+T3tUR7aCWM+dcpRDiND2eMExd8D6SmK/paU8jP3UOTSVPKOjRTFvLoUR56ZjRPMVbbOiJIUvc6JwDAAAIABAACAAQAAgAIAAIBPAQQ1h88EPylDaYAAAAKd2ARTZ1R4zZlIoqxVqbOOyyWSTxfYCt+PfRmBIcC+jgKq2eEaRRWoCvCgG2kO4EVyjv6kuD3sUrmMTGn2ihCpkhS9zonAMAAAgAEAAIACAACAAgAAgAABAIkCAAAAAdDCO6pPxRFJ+24BmCrnSNUzhk/H1OYAtzqXSJJ8Nx7sAQAAAACsAwAAAklpBAAAAAAAIlEgc5PAFxq4T+eGduJMQtmHx8mW6eh4FW17XzShU0pFd1AQJwAAAAAAACIAICinfQRT/UjLIU8kkB9AmOoIpQuzHDiZxnTFC5AhNafpAAAAAAEBKxAnAAAAAAAAIgAgKKd9BFP9SMshTySQH0CY6gilC7McOJnGdMULkCE1p+kBAwQBAAAAAQVpUiECmP9jwLoy4z2KhidQgcduKJAjOiL5iF9urF+7N6MU9/YhAwTPIlmDYdkCcFSlwdlsK8tm6oFb3mfmnlQZKM6j880BIQMsreYHj3qYxsb/FVjbqHj622j+dJDvTnbSTYvedowxs1OuIgYDBM8iWYNh2QJwVKXB2Wwry2bqgVveZ+aeVBkozqPzzQEcvc6JwDAAAIABAACAAAAAgAIAAIAAAAAAAQAAACIGAyyt5gePepjGxv8VWNuoePrbaP50kO9OdtJNi952jDGzHL3OicAwAACAAQAAgAEAAIACAACAAAAAAAEAAAAiBgKY/2PAujLjPYqGJ1CBx24okCM6IvmIX26sX7s3oxT39hy9zonAMAAAgAEAAIACAACAAgAAgAAAAAABAAAAAAABAWlSIQISbiTrrv85K4/5zMrnx6wIxrI7nG/qUpJ7SxTbUziG1yECgdK0nV0zJFywmY5ZyE7MoJAK5DbhYYIliqx0Tck7righA+lawFXKKJeUtvklD04IEmCoIkRGnZszF09YMUa5TiBVU64iAgISbiTrrv85K4/5zMrnx6wIxrI7nG/qUpJ7SxTbUziG1xy9zonAMAAAgAEAAIAAAACAAgAAgAEAAAABAAAAIgID6VrAVcool5S2+SUPTggSYKgiREadmzMXT1gxRrlOIFUcvc6JwDAAAIABAACAAQAAgAIAAIABAAAAAQAAACICAoHStJ1dMyRcsJmOWchOzKCQCuQ24WGCJYqsdE3JO64oHL3OicAwAACAAQAAgAIAAIACAACAAQAAAAEAAAAA';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.signedTransaction).toEqual('020000000001019a674b4eb1cfb8ed002c337c0084411698b095b0979dcb07f6534c86a57f34cb0100000000fdffffff0270170000000000002251203da931f134ce2717ff38488c0c1cb1e4d80362a82788aa6d6025aa950d34bcb4d70e000000000000220020d6357daac8fb2b08a602d3ab337ac720c672f4ad94ff6fbc7f7f1c430e5e25020400483045022100ee9de935b44b93d50dc92f69c71fb4d9e08f183edfaebfbe94e621ef1d221cbd0220712372511fd4f9229b679a2c0e3e338d037d28c8e82e5adc42afeacd13ae462101483045022100852df10d3d4b8bb8440a8ea84f17dbe6aed36b5412e508c8b702471e270767860220074cd45ed9f7e963cf0b1402de96df89eedf17964a67806f6eeaf265e5db6453016952210298ff63c0ba32e33d8a86275081c76e2890233a22f9885f6eac5fbb37a314f7f6210304cf22598361d9027054a5c1d96c2bcb66ea815bde67e69e541928cea3f3cd0121032cade6078f7a98c6c6ff1558dba878fadb68fe7490ef4e76d24d8bde768c31b353aed8b72500');
  });

  it(`should partially sign bip48`, () => {
    const text = 'cHNidP8BAIkCAAAAAQ4U2CZkBAP4dCPg2Gn5qvIBJecHR6yBsZEUrCvI/rMxAAAAAAD9////AugDAAAAAAAAIlEgPakx8TTOJxf/OEiMDByx5NgDYqgniKptYCWqlQ00vLQ+BgAAAAAAACIAINY1farI+ysIpgLTqzN6xyDGcvStlP9vvH9/HEMOXiUCmLwlAE8BBDWHzwSws+U1gAAAAhztXxAU+ixMlx/4G6PCe48OEsd5kBVN3i8OWTP8EzOYAn098S+ppFDGsktxQpoEEyOJrEdx4SO7i+3TGAWJ4ukbFL3OicAwAACAAQAAgAAAAIACAACATwEENYfPBBhO+xGAAAACk7k2tWbGW4D6vuor+T3tUR7aCWM+dcpRDiND2eMExd8D6SmK/paU8jP3UOTSVPKOjRTFvLoUR56ZjRPMVbbOiJIUvc6JwTAAAIABAACADQAAgAIAAIBPAQQ1h88EPylDaYAAAAKd2ARTZ1R4zZlIoqxVqbOOyyWSTxfYCt+PfRmBIcC+jgKq2eEaRRWoCvCgG2kO4EVyjv6kuD3sUrmMTGn2ihCpkhS9zonBMAAAgAEAAIAXAACAAgAAgAABAIkCAAAAAYoG+2jlgAyCblDsxc4KJcMOscATUHY3g2ad4Z+8XqskAQAAAAD9////Au8KAAAAAAAAIgAgXx1CmaRhboCXVuPzjAVvUULMj43yDfPvjRDq7YfyBR+IEwAAAAAAACJRIJptBrjgygb9/UcbLVFTpLZd4tNNlN0+S1acTXrhREdV1LclAAEBK+8KAAAAAAAAIgAgXx1CmaRhboCXVuPzjAVvUULMj43yDfPvjRDq7YfyBR8BAwQBAAAAAQVpUiECwyFEK4v4IAKCONubm6OlQlLx+edx7FJyWx7O7Yh/9F4hAuS3ODEiJmejHAzyBo/EAQS125jnuR34f9JSQXG4xd5NIQPtkTyC+OA1ie+UkesYa5QiIbTTdK806InnHALSc1kvpFOuIgYC5Lc4MSImZ6McDPIGj8QBBLXbmOe5Hfh/0lJBcbjF3k0cvc6JwDAAAIABAACAAAAAgAIAAIABAAAAAAAAACIGAsMhRCuL+CACgjjbm5ujpUJS8fnncexSclsezu2If/ReHL3OicEwAACAAQAAgA0AAIACAACAAQAAAAAAAAAiBgPtkTyC+OA1ie+UkesYa5QiIbTTdK806InnHALSc1kvpBy9zonBMAAAgAEAAIAXAACAAgAAgAEAAAAAAAAAAAABAWlSIQISbiTrrv85K4/5zMrnx6wIxrI7nG/qUpJ7SxTbUziG1yECgdK0nV0zJFywmY5ZyE7MoJAK5DbhYYIliqx0Tck7righA+lawFXKKJeUtvklD04IEmCoIkRGnZszF09YMUa5TiBVU64iAgISbiTrrv85K4/5zMrnx6wIxrI7nG/qUpJ7SxTbUziG1xy9zonAMAAAgAEAAIAAAACAAgAAgAEAAAABAAAAIgID6VrAVcool5S2+SUPTggSYKgiREadmzMXT1gxRrlOIFUcvc6JwTAAAIABAACADQAAgAIAAIABAAAAAQAAACICAoHStJ1dMyRcsJmOWchOzKCQCuQ24WGCJYqsdE3JO64oHL3OicEwAACAAQAAgBcAAIACAACAAQAAAAEAAAAA';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.inputSignResultList[0].threshold).toEqual(2);
    expect(signResult.inputSignResultList[0].signedCount).toEqual(1);
    expect(signResult.psbtBase64).toEqual('cHNidP8BAIkCAAAAAQ4U2CZkBAP4dCPg2Gn5qvIBJecHR6yBsZEUrCvI/rMxAAAAAAD9////AugDAAAAAAAAIlEgPakx8TTOJxf/OEiMDByx5NgDYqgniKptYCWqlQ00vLQ+BgAAAAAAACIAINY1farI+ysIpgLTqzN6xyDGcvStlP9vvH9/HEMOXiUCmLwlAE8BBDWHzwQYTvsRgAAAApO5NrVmxluA+r7qK/k97VEe2gljPnXKUQ4jQ9njBMXfA+kpiv6WlPIz91Dk0lTyjo0Uxby6FEeemY0TzFW2zoiSFL3OicEwAACAAQAAgA0AAIACAACATwEENYfPBD8pQ2mAAAACndgEU2dUeM2ZSKKsVamzjsslkk8X2Arfj30ZgSHAvo4CqtnhGkUVqArwoBtpDuBFco7+pLg97FK5jExp9ooQqZIUvc6JwTAAAIABAACAFwAAgAIAAIBPAQQ1h88EsLPlNYAAAAIc7V8QFPosTJcf+BujwnuPDhLHeZAVTd4vDlkz/BMzmAJ9PfEvqaRQxrJLcUKaBBMjiaxHceEju4vt0xgFieLpGxS9zonAMAAAgAEAAIAAAACAAgAAgAABAIkCAAAAAYoG+2jlgAyCblDsxc4KJcMOscATUHY3g2ad4Z+8XqskAQAAAAD9////Au8KAAAAAAAAIgAgXx1CmaRhboCXVuPzjAVvUULMj43yDfPvjRDq7YfyBR+IEwAAAAAAACJRIJptBrjgygb9/UcbLVFTpLZd4tNNlN0+S1acTXrhREdV1LclAAEBK+8KAAAAAAAAIgAgXx1CmaRhboCXVuPzjAVvUULMj43yDfPvjRDq7YfyBR8iAgLktzgxIiZnoxwM8gaPxAEEtduY57kd+H/SUkFxuMXeTUgwRQIhAPmcyGAsB3QWTEv0J0yjgf0Gv8AG7N7y5fKKmJINitEnAiA64jx/EVPWiSKT9O6oG7+NVuHkWOHGZVCGan5rW1qEQgEBAwQBAAAAAQVpUiECwyFEK4v4IAKCONubm6OlQlLx+edx7FJyWx7O7Yh/9F4hAuS3ODEiJmejHAzyBo/EAQS125jnuR34f9JSQXG4xd5NIQPtkTyC+OA1ie+UkesYa5QiIbTTdK806InnHALSc1kvpFOuIgYCwyFEK4v4IAKCONubm6OlQlLx+edx7FJyWx7O7Yh/9F4cvc6JwTAAAIABAACADQAAgAIAAIABAAAAAAAAACIGAuS3ODEiJmejHAzyBo/EAQS125jnuR34f9JSQXG4xd5NHL3OicAwAACAAQAAgAAAAIACAACAAQAAAAAAAAAiBgPtkTyC+OA1ie+UkesYa5QiIbTTdK806InnHALSc1kvpBy9zonBMAAAgAEAAIAXAACAAgAAgAEAAAAAAAAAAAABAWlSIQISbiTrrv85K4/5zMrnx6wIxrI7nG/qUpJ7SxTbUziG1yECgdK0nV0zJFywmY5ZyE7MoJAK5DbhYYIliqx0Tck7righA+lawFXKKJeUtvklD04IEmCoIkRGnZszF09YMUa5TiBVU64iAgISbiTrrv85K4/5zMrnx6wIxrI7nG/qUpJ7SxTbUziG1xy9zonAMAAAgAEAAIAAAACAAgAAgAEAAAABAAAAIgICgdK0nV0zJFywmY5ZyE7MoJAK5DbhYYIliqx0Tck7rigcvc6JwTAAAIABAACAFwAAgAIAAIABAAAAAQAAACICA+lawFXKKJeUtvklD04IEmCoIkRGnZszF09YMUa5TiBVHL3OicEwAACAAQAAgA0AAIACAACAAQAAAAEAAAAA');
  });

  it(`should sign using keypath with unused script`, () => {
    const text = 'cHNidP8BAIkCAAAAAWOJEj3tZs774xsQ5rxRQITffG4jyzU/M6T8AgRK18f/AQAAAAD/////AhAnAAAAAAAAIlEgoZr6L+eRgcf0VgoYGEW5cW4AgcLTebCX5wDiSpy5QsX2XgEAAAAAACJRINuj2q2wLNahAn8huIcIYpbP7yI9Iz6L0nR8qVK9WOYTAAAAAAABASughgEAAAAAACJRIDTCYjYLVB4I/p0wQ5+4dmKd/pGyaEFSMz7fbYkf8ySTIhXBFfmw5v2XXpuU6vKIz3xbUZ6m9JBXi6Pxm7yG5wtKNNdpIG3QmcbItdbpHz9xJNGdfUtlA8qOa8zMfsl+3pET5Bc+rCCBm7iYhMqeCjglUVhDZqvPGzZNhzRPAKBAOQ8xYoOtwbogva9ee+wzolIdNcyOvqnLyyFNgSt4OrCNWRWBkZbVMTW6UpzAIRYV+bDm/Zdem5Tq8ojPfFtRnqb0kFeLo/GbvIbnC0o01xkAvc6JwFYAAIABAACAAAAAgAAAAAAAAAAAIRZt0JnGyLXW6R8/cSTRnX1LZQPKjmvMzH7Jft6RE+QXPj0Bbo4ze3Kfkot7wWMt2pS3qD3ifXg+L4hZBM6spzuQCG+9zonAMAAAgAEAAIAAAACAAgAAgAAAAAAAAAAAIRaBm7iYhMqeCjglUVhDZqvPGzZNhzRPAKBAOQ8xYoOtwT0Bbo4ze3Kfkot7wWMt2pS3qD3ifXg+L4hZBM6spzuQCG+9zonAMAAAgAEAAIABAACAAgAAgAAAAAAAAAAAIRa9r1577DOiUh01zI6+qcvLIU2BK3g6sI1ZFYGRltUxNT0Bbo4ze3Kfkot7wWMt2pS3qD3ifXg+L4hZBM6spzuQCG+9zonAMAAAgAEAAIACAACAAgAAgAAAAAAAAAAAARcgFfmw5v2XXpuU6vKIz3xbUZ6m9JBXi6Pxm7yG5wtKNNcBGCBujjN7cp+Si3vBYy3alLeoPeJ9eD4viFkEzqynO5AIbwAAAQZrAMBoIGuvN9LvJ+0Pm6GCknSwYSnmMkwyyjK5CQ/zHhNjDxjCrCDflW6Q+ZcDfEPk3HKy681etNTOdqjFSG7qTTL0ncK8jrog/+S3LpRAZaOW3AIZXJXbyDynTgk1SywINHstKo6/1VW6UpwhByuiEqok8F90P+YXbxX2BMRrNDFNorq6J0wCnG6k396RGQC9zonAVgAAgAEAAIAAAACAAQAAAAAAAAAhB2uvN9LvJ+0Pm6GCknSwYSnmMkwyyjK5CQ/zHhNjDxjCPQH9Wtr3EVu2RvamgwYZ3tbmmH8y4ywOlyj2Cugt2cw87b3OicAwAACAAQAAgAEAAIACAACAAQAAAAAAAAAhB9+VbpD5lwN8Q+TccrLrzV601M52qMVIbupNMvSdwryOPQH9Wtr3EVu2RvamgwYZ3tbmmH8y4ywOlyj2Cugt2cw87b3OicAwAACAAQAAgAIAAIACAACAAQAAAAAAAAAhB//kty6UQGWjltwCGVyV28g8p04JNUssCDR7LSqOv9VVPQH9Wtr3EVu2RvamgwYZ3tbmmH8y4ywOlyj2Cugt2cw87b3OicAwAACAAQAAgAAAAIACAACAAQAAAAAAAAAA';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.signedTransaction).toEqual('020000000001016389123ded66cefbe31b10e6bc514084df7c6e23cb353f33a4fc02044ad7c7ff0100000000ffffffff021027000000000000225120a19afa2fe79181c7f4560a181845b9716e0081c2d379b097e700e24a9cb942c5f65e010000000000225120dba3daadb02cd6a1027f21b887086296cfef223d233e8bd2747ca952bd58e6130140366a1c637c8623c2feaa145ada1b0e6915c5ad1fc6e326ac4eedc1029c5340de09c8aa747e86743b40420d1296869d9edafaa82cdf46ea8b395852a7958c209400000000');
  });

  it(`should sign using scriptpath`, () => {
    const text = 'cHNidP8BAIkCAAAAAaA14xVDitpHgYm5UKlNIEkFF0mHaonFu+CrXGBXff7pAQAAAAD/////AhAnAAAAAAAAIlEgAUXOe9TJQ1kgr9SvJSGH3IPCVcFGF2dqFuZrY1L7J8TKDgEAAAAAACJRIFO/rVfAQqva/7yJ4MIJsjYbaH0eTNY1LG3CnDsL80zfAAAAAAABASu8NgEAAAAAACJRIM12K3vsfRTpBXi8OvUWzkgPzC3dEJ9qGNC6p26BfI5vIhXArH/c9AMRcol1LOdN+AnH9KvCV3CAP8t36SD4BRR74TJpIBJuJOuu/zkrj/nMyufHrAjGsjucb+pSkntLFNtTOIbXrCCB0rSdXTMkXLCZjlnITsygkArkNuFhgiWKrHRNyTuuKLog6VrAVcool5S2+SUPTggSYKgiREadmzMXT1gxRrlOIFW6UpzAIRYSbiTrrv85K4/5zMrnx6wIxrI7nG/qUpJ7SxTbUziG1z0BcdS67dN8nftiEdJf2Z4FCL9aJDS/Dk3h1jWpyOEiPQO9zonAMAAAgAEAAIAAAACAAgAAgAEAAAABAAAAIRaB0rSdXTMkXLCZjlnITsygkArkNuFhgiWKrHRNyTuuKD0BcdS67dN8nftiEdJf2Z4FCL9aJDS/Dk3h1jWpyOEiPQP/////MAAAgAEAAIACAACAAgAAgAEAAAABAAAAIRasf9z0AxFyiXUs5034Ccf0q8JXcIA/y3fpIPgFFHvhMhkA/////1YAAIABAACAAAAAgAEAAAABAAAAIRbpWsBVyiiXlLb5JQ9OCBJgqCJERp2bMxdPWDFGuU4gVT0BcdS67dN8nftiEdJf2Z4FCL9aJDS/Dk3h1jWpyOEiPQO9zonAMAAAgAEAAIABAACAAgAAgAEAAAABAAAAARcgrH/c9AMRcol1LOdN+AnH9KvCV3CAP8t36SD4BRR74TIBGCBx1Lrt03yd+2IR0l/ZngUIv1okNL8OTeHWNanI4SI9AwAAAQZrAMBoICGL1g3j7BGyHnB203YD8OcEa92m4CRPmnU5V/eLE22OrCA8W92T28RfDxq7o9ciNFI5UP87Un3nS4zA9rwCBJlhN7ogTd3HK7KhsScaJOmg9CJkC091dAnfkk6HRXgc/MA/xCe6UpwhByGL1g3j7BGyHnB203YD8OcEa92m4CRPmnU5V/eLE22OPQHr1TST/mrcqE+KelI1BXfvi34LhOS5pYmS8Lj97ItlPr3OicAwAACAAQAAgAEAAIACAACAAQAAAAIAAAAhBzxb3ZPbxF8PGruj1yI0UjlQ/ztSfedLjMD2vAIEmWE3PQHr1TST/mrcqE+KelI1BXfvi34LhOS5pYmS8Lj97ItlPr3OicAwAACAAQAAgAAAAIACAACAAQAAAAIAAAAhB03dxyuyobEnGiTpoPQiZAtPdXQJ35JOh0V4HPzAP8QnPQHr1TST/mrcqE+KelI1BXfvi34LhOS5pYmS8Lj97ItlPv////8wAACAAQAAgAIAAIACAACAAQAAAAIAAAAhB/lgNrMVLMz85PRgYhMIjfP+G47vDzl2b9kX65FeUEt0GQD/////VgAAgAEAAIAAAACAAQAAAAIAAAAA';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.signedTransaction).toEqual('02000000000101a035e315438ada478189b950a94d2049051749876a89c5bbe0ab5c60577dfee90100000000ffffffff0210270000000000002251200145ce7bd4c9435920afd4af252187dc83c255c14617676a16e66b6352fb27c4ca0e01000000000022512053bfad57c042abdaffbc89e0c209b2361b687d1e4cd6352c6dc29c3b0bf34cdf05409f03de23807d164fbfd7a7d60e5b0609df3d3b0094fb97135c8ea84c2d35c96b0a742ba37ef9868ba465e97b1039d181d5e803e4318f5745796ef88b4bb1d44e004052cefac626c0caa501f9958a804f0948ad56744011cc9f005a1ad502dfbe3c5d9b1321f5660800fdc72c21a416063ef26cc2ced54c560f3b39284ccf9e0cf0766820126e24ebaeff392b8ff9cccae7c7ac08c6b23b9c6fea52927b4b14db533886d7ac2081d2b49d5d33245cb0998e59c84ecca0900ae436e16182258aac744dc93bae28ba20e95ac055ca289794b6f9250f4e081260a82244469d9b33174f583146b94e2055ba529c21c0ac7fdcf403117289752ce74df809c7f4abc25770803fcb77e920f805147be13200000000');
  });

  it(`should partially sign using scriptpath`, () => {
    const text = 'cHNidP8BAIkCAAAAAWOJEj3tZs774xsQ5rxRQITffG4jyzU/M6T8AgRK18f/AQAAAAD/////AhAnAAAAAAAAIlEgoZr6L+eRgcf0VgoYGEW5cW4AgcLTebCX5wDiSpy5QsX2XgEAAAAAACJRIIa6/HVjaYCX7bbgxRy6ehRUJlH2iSjA6d1CvbzWsB43AAAAAAABASughgEAAAAAACJRIDTCYjYLVB4I/p0wQ5+4dmKd/pGyaEFSMz7fbYkf8ySTIhXBD2YfUdidP/oUt1zaD3qxm8eIFjZeTCGhhdf0N53a8T1pIAJRii41jpi472XdRHNSDU3wDb/SMVc58PTEK3sYMaIarCCoH/U6qY9kXzU7sp17BZZ1NefhSCqVG+NSYWo78eHZfrog0kjSHWLKF+D0NM7Zj336Gim9NPnYNzSuPNKh5L6yWTq6UpzAIRYCUYouNY6YuO9l3URzUg1N8A2/0jFXOfD0xCt7GDGiGj0BH8mUM8Hr9Qpx3OdfcoIefYKBuTHHYR8Jln9XJqyjOCK9zonAMAAAgAEAAIACAACAAgAAgAAAAAAAAAAAIRYPZh9R2J0/+hS3XNoPerGbx4gWNl5MIaGF1/Q3ndrxPRkA/////1YAAIABAACAAAAAgAAAAAAAAAAAIRaoH/U6qY9kXzU7sp17BZZ1NefhSCqVG+NSYWo78eHZfj0BH8mUM8Hr9Qpx3OdfcoIefYKBuTHHYR8Jln9XJqyjOCL/////MAAAgAEAAIABAACAAgAAgAAAAAAAAAAAIRbSSNIdYsoX4PQ0ztmPffoaKb00+dg3NK480qHkvrJZOj0BH8mUM8Hr9Qpx3OdfcoIefYKBuTHHYR8Jln9XJqyjOCL/////MAAAgAEAAIAAAACAAgAAgAAAAAAAAAAAARcgD2YfUdidP/oUt1zaD3qxm8eIFjZeTCGhhdf0N53a8T0BGCAfyZQzwev1CnHc519ygh59goG5McdhHwmWf1cmrKM4IgAAAQZrAMBoIMMhRCuL+CACgjjbm5ujpUJS8fnncexSclsezu2If/RerCDktzgxIiZnoxwM8gaPxAEEtduY57kd+H/SUkFxuMXeTbog7ZE8gvjgNYnvlJHrGGuUIiG003SvNOiJ5xwC0nNZL6S6UpwhBzFWepNLUNyXoWwUAy/0vvw/gDlvfk89g8XoKNNiLXerGQD/////VgAAgAEAAIAAAACAAQAAAAAAAAAhB8MhRCuL+CACgjjbm5ujpUJS8fnncexSclsezu2If/RePQGLJpZwUWECOtE90k7hjARPFnxi5MC1Zt8XxetNgAqQ7v////8wAACAAQAAgAEAAIACAACAAQAAAAAAAAAhB+S3ODEiJmejHAzyBo/EAQS125jnuR34f9JSQXG4xd5NPQGLJpZwUWECOtE90k7hjARPFnxi5MC1Zt8XxetNgAqQ7v////8wAACAAQAAgAAAAIACAACAAQAAAAAAAAAhB+2RPIL44DWJ75SR6xhrlCIhtNN0rzToieccAtJzWS+kPQGLJpZwUWECOtE90k7hjARPFnxi5MC1Zt8XxetNgAqQ7r3OicAwAACAAQAAgAIAAIACAACAAQAAAAAAAAAA';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.inputSignResultList[0].threshold).toEqual(2);
    expect(signResult.inputSignResultList[0].signedCount).toEqual(1);
    expect(signResult.psbtBase64).toEqual('cHNidP8BAIkCAAAAAWOJEj3tZs774xsQ5rxRQITffG4jyzU/M6T8AgRK18f/AQAAAAD/////AhAnAAAAAAAAIlEgoZr6L+eRgcf0VgoYGEW5cW4AgcLTebCX5wDiSpy5QsX2XgEAAAAAACJRIIa6/HVjaYCX7bbgxRy6ehRUJlH2iSjA6d1CvbzWsB43AAAAAAABASughgEAAAAAACJRIDTCYjYLVB4I/p0wQ5+4dmKd/pGyaEFSMz7fbYkf8ySTQRQCUYouNY6YuO9l3URzUg1N8A2/0jFXOfD0xCt7GDGiGh/JlDPB6/UKcdznX3KCHn2Cgbkxx2EfCZZ/VyasozgiQD8sUb236xnbTUt45HMXFD9UAk+dEHia33yux47OZkzzNzYsuap8M5R3xqFQi2cXbdICitFU0HPfnLc6ER+hOqciFcEPZh9R2J0/+hS3XNoPerGbx4gWNl5MIaGF1/Q3ndrxPWkgAlGKLjWOmLjvZd1Ec1INTfANv9IxVznw9MQrexgxohqsIKgf9Tqpj2RfNTuynXsFlnU15+FIKpUb41Jhajvx4dl+uiDSSNIdYsoX4PQ0ztmPffoaKb00+dg3NK480qHkvrJZOrpSnMAhFgJRii41jpi472XdRHNSDU3wDb/SMVc58PTEK3sYMaIaPQEfyZQzwev1CnHc519ygh59goG5McdhHwmWf1cmrKM4Ir3OicAwAACAAQAAgAIAAIACAACAAAAAAAAAAAAhFg9mH1HYnT/6FLdc2g96sZvHiBY2XkwhoYXX9Ded2vE9GQD/////VgAAgAEAAIAAAACAAAAAAAAAAAAhFqgf9Tqpj2RfNTuynXsFlnU15+FIKpUb41Jhajvx4dl+PQEfyZQzwev1CnHc519ygh59goG5McdhHwmWf1cmrKM4Iv////8wAACAAQAAgAEAAIACAACAAAAAAAAAAAAhFtJI0h1iyhfg9DTO2Y99+hopvTT52Dc0rjzSoeS+slk6PQEfyZQzwev1CnHc519ygh59goG5McdhHwmWf1cmrKM4Iv////8wAACAAQAAgAAAAIACAACAAAAAAAAAAAABFyAPZh9R2J0/+hS3XNoPerGbx4gWNl5MIaGF1/Q3ndrxPQEYIB/JlDPB6/UKcdznX3KCHn2Cgbkxx2EfCZZ/VyasozgiAAABBmsAwGggwyFEK4v4IAKCONubm6OlQlLx+edx7FJyWx7O7Yh/9F6sIOS3ODEiJmejHAzyBo/EAQS125jnuR34f9JSQXG4xd5NuiDtkTyC+OA1ie+UkesYa5QiIbTTdK806InnHALSc1kvpLpSnCEHMVZ6k0tQ3JehbBQDL/S+/D+AOW9+Tz2Dxego02Itd6sZAP////9WAACAAQAAgAAAAIABAAAAAAAAACEHwyFEK4v4IAKCONubm6OlQlLx+edx7FJyWx7O7Yh/9F49AYsmlnBRYQI60T3STuGMBE8WfGLkwLVm3xfF602ACpDu/////zAAAIABAACAAQAAgAIAAIABAAAAAAAAACEH5Lc4MSImZ6McDPIGj8QBBLXbmOe5Hfh/0lJBcbjF3k09AYsmlnBRYQI60T3STuGMBE8WfGLkwLVm3xfF602ACpDu/////zAAAIABAACAAAAAgAIAAIABAAAAAAAAACEH7ZE8gvjgNYnvlJHrGGuUIiG003SvNOiJ5xwC0nNZL6Q9AYsmlnBRYQI60T3STuGMBE8WfGLkwLVm3xfF602ACpDuvc6JwDAAAIABAACAAgAAgAIAAIABAAAAAAAAAAA=');
  });

  it(`should not error when already signed`, () => {
    const text = 'cHNidP8BAIkCAAAAAWOJEj3tZs774xsQ5rxRQITffG4jyzU/M6T8AgRK18f/AQAAAAD/////AhAnAAAAAAAAIlEgoZr6L+eRgcf0VgoYGEW5cW4AgcLTebCX5wDiSpy5QsX2XgEAAAAAACJRIP7o+tsGLmKwJILkoeiUDz/NtLUsYzksFfH7mOHIWZ4FAAAAAAABASughgEAAAAAACJRIDTCYjYLVB4I/p0wQ5+4dmKd/pGyaEFSMz7fbYkf8ySTIhXBFfmw5v2XXpuU6vKIz3xbUZ6m9JBXi6Pxm7yG5wtKNNdpIAJRii41jpi472XdRHNSDU3wDb/SMVc58PTEK3sYMaIarCCoH/U6qY9kXzU7sp17BZZ1NefhSCqVG+NSYWo78eHZfrog0kjSHWLKF+D0NM7Zj336Gim9NPnYNzSuPNKh5L6yWTq6UpzAIRYCUYouNY6YuO9l3URzUg1N8A2/0jFXOfD0xCt7GDGiGj0BH8mUM8Hr9Qpx3OdfcoIefYKBuTHHYR8Jln9XJqyjOCK9zonAMAAAgAEAAIACAACAAgAAgAAAAAAAAAAAIRYV+bDm/Zdem5Tq8ojPfFtRnqb0kFeLo/GbvIbnC0o01xkA/////1YAAIABAACAAAAAgAAAAAAAAAAAIRaoH/U6qY9kXzU7sp17BZZ1NefhSCqVG+NSYWo78eHZfj0BH8mUM8Hr9Qpx3OdfcoIefYKBuTHHYR8Jln9XJqyjOCK9zonAMAAAgAEAAIABAACAAgAAgAAAAAAAAAAAIRbSSNIdYsoX4PQ0ztmPffoaKb00+dg3NK480qHkvrJZOj0BH8mUM8Hr9Qpx3OdfcoIefYKBuTHHYR8Jln9XJqyjOCL/////MAAAgAEAAIAAAACAAgAAgAAAAAAAAAAAARcgFfmw5v2XXpuU6vKIz3xbUZ6m9JBXi6Pxm7yG5wtKNNcBGCAfyZQzwev1CnHc519ygh59goG5McdhHwmWf1cmrKM4IgAAAQZrAMBoIMMhRCuL+CACgjjbm5ujpUJS8fnncexSclsezu2If/RerCDktzgxIiZnoxwM8gaPxAEEtduY57kd+H/SUkFxuMXeTbog7ZE8gvjgNYnvlJHrGGuUIiG003SvNOiJ5xwC0nNZL6S6UpwhByuiEqok8F90P+YXbxX2BMRrNDFNorq6J0wCnG6k396RGQD/////VgAAgAEAAIAAAACAAQAAAAAAAAAhB8MhRCuL+CACgjjbm5ujpUJS8fnncexSclsezu2If/RePQGLJpZwUWECOtE90k7hjARPFnxi5MC1Zt8XxetNgAqQ7r3OicAwAACAAQAAgAEAAIACAACAAQAAAAAAAAAhB+S3ODEiJmejHAzyBo/EAQS125jnuR34f9JSQXG4xd5NPQGLJpZwUWECOtE90k7hjARPFnxi5MC1Zt8XxetNgAqQ7v////8wAACAAQAAgAAAAIACAACAAQAAAAAAAAAhB+2RPIL44DWJ75SR6xhrlCIhtNN0rzToieccAtJzWS+kPQGLJpZwUWECOtE90k7hjARPFnxi5MC1Zt8XxetNgAqQ7r3OicAwAACAAQAAgAIAAIACAACAAQAAAAAAAAAA';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.regtest;
    const instance = Psbt.fromBase64(text, network);

    const signResult = instance.sign(mnemonic);

    expect(signResult.signedTransaction).toEqual('020000000001016389123ded66cefbe31b10e6bc514084df7c6e23cb353f33a4fc02044ad7c7ff0100000000ffffffff021027000000000000225120a19afa2fe79181c7f4560a181845b9716e0081c2d379b097e700e24a9cb942c5f65e010000000000225120fee8fadb062e62b02482e4a1e8940f3fcdb4b52c63392c15f1fb98e1c8599e050500409bbb51b233afce2ccf9aedb623119f77ea0c8748bc987c258b10b3fb08a2ad7e6c3063d2da11823185ab621e1ba3fe9232d6daf6d873e3705273d7937cd9979a402ea048f9b60419c8fb16eb75aa4503482701f00ad31f12ff0e781183258e96f2406348deaed5cfdd183d35b51bfd0f2f1e20c2dab995a11e89c433804a750e61682002518a2e358e98b8ef65dd4473520d4df00dbfd2315739f0f4c42b7b1831a21aac20a81ff53aa98f645f353bb29d7b05967535e7e1482a951be352616a3bf1e1d97eba20d248d21d62ca17e0f434ced98f7dfa1a29bd34f9d83734ae3cd2a1e4beb2593aba529c21c115f9b0e6fd975e9b94eaf288cf7c5b519ea6f490578ba3f19bbc86e70b4a34d700000000');
  });

  it(`should partially sign joined psbt single sig and keypath`, () => {
    const text = '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';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    const network = bitcoinjs.networks.testnet;
    const instance = Psbt.fromBase64(text, network);

    let signResult = instance.sign(mnemonic);

    expect(signResult.inputSignResultList[0].signedCount).toEqual(0);
    expect(signResult.inputSignResultList[0].threshold).toEqual(2);
    expect(signResult.inputSignResultList[1].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[1].threshold).toEqual(1);
    expect(signResult.inputSignResultList[2].signedCount).toEqual(0);
    expect(signResult.inputSignResultList[2].threshold).toEqual(2);
    expect(signResult.inputSignResultList[3].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[3].threshold).toEqual(1);
    expect(signResult.psbtBase64).toEqual('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');
    
    mnemonic.phrase = 'tomorrow gather veteran below mimic hollow wasp bundle traffic afford task federal glide eternal whip other sunset negative reject month eye boil age imitate';
    signResult = instance.sign(mnemonic);
    
    expect(signResult.inputSignResultList[0].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[0].signatureCount).toEqual(1);
    expect(signResult.inputSignResultList[0].threshold).toEqual(2);
    expect(signResult.inputSignResultList[1].signedCount).toEqual(0);
    expect(signResult.inputSignResultList[2].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[2].signatureCount).toEqual(1);
    expect(signResult.inputSignResultList[2].threshold).toEqual(2);
    expect(signResult.inputSignResultList[3].signedCount).toEqual(0);
    expect(signResult.psbtBase64).toEqual('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');

    mnemonic.phrase = 'equal year choice ritual decade dirt wool usual curious romance curtain hurdle tourist myself lucky prepare pill sausage exhibit vacuum agent option exit purchase';
    signResult = instance.sign(mnemonic);
    
    expect(signResult.inputSignResultList[0].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[0].signatureCount).toEqual(2);
    expect(signResult.inputSignResultList[0].threshold).toEqual(2);
    expect(signResult.inputSignResultList[1].signedCount).toEqual(0);
    expect(signResult.inputSignResultList[2].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[2].signatureCount).toEqual(2);
    expect(signResult.inputSignResultList[2].threshold).toEqual(2);
    expect(signResult.inputSignResultList[3].signedCount).toEqual(0);
    expect(signResult.signedTransaction).toEqual('020000000001041f511c4378fcfd96415beb518757410540e4e16ef695267566e4d79a10b9df3d0000000000ffffffff78aff1525c66815f8f36ffe5273bbfbdb9c1696e633f856b25522845c52bce870200000000ffffffff78aff1525c66815f8f36ffe5273bbfbdb9c1696e633f856b25522845c52bce870100000000ffffffff1f511c4378fcfd96415beb518757410540e4e16ef695267566e4d79a10b9df3d0100000000ffffffff0610270000000000002251200fa7cf19110107cc2e5c784e5a3a3b20f492d7ca136e38abe34597eeb2643ffbc1790100000000002200207f22d239d52cb1422f9edf55e8994f937222797a056bf4f259cb3868f929eda93b2f010000000000225120baa02ce8666fa349f7ccfa094649063959f195ad22b85985942072926fc52784e02e000000000000220020b576c9c985302b3365c547d15f73b250043c1aeb9aa55d1c8503216451f25beaf82a0000000000002251206c42bb2d21df4d292a85823ada475ae4b3578874cbfd6458b28269bf3a82da14f75f010000000000225120e75d7543fc3f06367e91e5c9e3c92df3eb6fa80aa25afb5d5eca1aa2428f989c04004730440220635956b3a4aedfaa0e48189b63940f79406cc8170cb211724a671466b56c53ee02204c5c77ab8a498577a41d4dc5a866b36a2978dced978c062a2abc95d2038c91670148304502210089f29c0f6a9b0b1c3400feb678fa89717279e74cc83ef54552eb22631806e57d0220558cf0abb7178177c2e77b4010e4779cccd86011e2280ea05ce1f7aa77df17ec0169522102cd47ae4cfb7b3fa202b272c0365a54b7f0a23bd2b6ca8b1368a122116f0e83c02103b10b9659bff7bbe5e9ff48e9d6bb5af50938456c42c93aea70959d1ec5b4fcc82103ebe4d67ce8be202ae3bdf0ba688ac1846ebc22f732b162bb39cb3d0d332d5a4753ae0140f88026b1e2e31168e47bc2be274499e9029651fab56e5708c733293c416edb716e2efbe00d6eb6fd37b09c6f5f15a3f07879ce2a0175a022e02be366b1bba8e30400483045022100c0d2cd4608cbe6ce0f63f20d7722dcad7e9be41ad8ed31f43f2fdcc4333a6ffb02205e1ae53546914379fd6862b0198122990fe00ee4404e041f62e4a591becf7e980148304502210083758a4e1327df7e1687a326b649b34c6e11fc829a5b731816112c326e4c3a9102206f9c8c179996777e9728c1f3cd85d0281b6dfc43ac7705a3068498df62bc84640169522102cd47ae4cfb7b3fa202b272c0365a54b7f0a23bd2b6ca8b1368a122116f0e83c02103b10b9659bff7bbe5e9ff48e9d6bb5af50938456c42c93aea70959d1ec5b4fcc82103ebe4d67ce8be202ae3bdf0ba688ac1846ebc22f732b162bb39cb3d0d332d5a4753ae01407a9d640726ee4e01fd18f9f27971d9a239c83d44ca0e065c1c91042625a6d3f25d99b4669555f17206bb85c4a60f8c597ec4855b4d498e2b66ab9ce54d44ddcf00000000');
  });

  it(`should partially sign joined psbt single sig and keypath`, () => {
    const text = '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';
    const mnemonic = new Mnemonic();
    mnemonic.phrase = 'tomorrow gather veteran below mimic hollow wasp bundle traffic afford task federal glide eternal whip other sunset negative reject month eye boil age imitate';
    const network = bitcoinjs.networks.testnet;
    const instance = Psbt.fromBase64(text, network);

    let signResult = instance.sign(mnemonic);

    expect(signResult.inputSignResultList[0].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[0].signatureCount).toEqual(1);
    expect(signResult.inputSignResultList[0].threshold).toEqual(2);
    expect(signResult.inputSignResultList[1].signedCount).toEqual(0);
    expect(signResult.inputSignResultList[1].threshold).toEqual(1);
    expect(signResult.inputSignResultList[2].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[2].signatureCount).toEqual(1);
    expect(signResult.inputSignResultList[2].threshold).toEqual(2);
    expect(signResult.inputSignResultList[3].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[3].signatureCount).toEqual(1);
    expect(signResult.inputSignResultList[3].threshold).toEqual(2);

    mnemonic.phrase = 'equal year choice ritual decade dirt wool usual curious romance curtain hurdle tourist myself lucky prepare pill sausage exhibit vacuum agent option exit purchase';
    signResult = instance.sign(mnemonic);

    expect(signResult.inputSignResultList[0].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[0].signatureCount).toEqual(2);
    expect(signResult.inputSignResultList[0].threshold).toEqual(2);
    expect(signResult.inputSignResultList[1].signedCount).toEqual(0);
    expect(signResult.inputSignResultList[1].threshold).toEqual(1);
    expect(signResult.inputSignResultList[2].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[2].signatureCount).toEqual(2);
    expect(signResult.inputSignResultList[2].threshold).toEqual(2);
    expect(signResult.inputSignResultList[3].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[3].signatureCount).toEqual(2);
    expect(signResult.inputSignResultList[3].threshold).toEqual(2);

    mnemonic.phrase = 'wool bullet crunch trend acoustic text swap flash video news bless second';
    signResult = instance.sign(mnemonic);

    expect(signResult.inputSignResultList[0].signedCount).toEqual(0);
    expect(signResult.inputSignResultList[1].signedCount).toEqual(1);
    expect(signResult.inputSignResultList[1].threshold).toEqual(1);
    expect(signResult.inputSignResultList[2].signedCount).toEqual(0);
    expect(signResult.inputSignResultList[3].signedCount).toEqual(0);
    expect(signResult.signedTransaction).toEqual('020000000001041f511c4378fcfd96415beb518757410540e4e16ef695267566e4d79a10b9df3d0000000000ffffffff78aff1525c66815f8f36ffe5273bbfbdb9c1696e633f856b25522845c52bce870200000000ffffffff78aff1525c66815f8f36ffe5273bbfbdb9c1696e633f856b25522845c52bce870100000000ffffffff1f511c4378fcfd96415beb518757410540e4e16ef695267566e4d79a10b9df3d0100000000ffffffff0610270000000000002251200fa7cf19110107cc2e5c784e5a3a3b20f492d7ca136e38abe34597eeb2643ffbc1790100000000002200207f22d239d52cb1422f9edf55e8994f937222797a056bf4f259cb3868f929eda93b2f010000000000225120baa02ce8666fa349f7ccfa094649063959f195ad22b85985942072926fc52784e02e000000000000220020b576c9c985302b3365c547d15f73b250043c1aeb9aa55d1c8503216451f25beaf82a0000000000002251206c42bb2d21df4d292a85823ada475ae4b3578874cbfd6458b28269bf3a82da14f75f010000000000225120e75d7543fc3f06367e91e5c9e3c92df3eb6fa80aa25afb5d5eca1aa2428f989c04004730440220635956b3a4aedfaa0e48189b63940f79406cc8170cb211724a671466b56c53ee02204c5c77ab8a498577a41d4dc5a866b36a2978dced978c062a2abc95d2038c91670148304502210089f29c0f6a9b0b1c3400feb678fa89717279e74cc83ef54552eb22631806e57d0220558cf0abb7178177c2e77b4010e4779cccd86011e2280ea05ce1f7aa77df17ec0169522102cd47ae4cfb7b3fa202b272c0365a54b7f0a23bd2b6ca8b1368a122116f0e83c02103b10b9659bff7bbe5e9ff48e9d6bb5af50938456c42c93aea70959d1ec5b4fcc82103ebe4d67ce8be202ae3bdf0ba688ac1846ebc22f732b162bb39cb3d0d332d5a4753ae0140f88026b1e2e31168e47bc2be274499e9029651fab56e5708c733293c416edb716e2efbe00d6eb6fd37b09c6f5f15a3f07879ce2a0175a022e02be366b1bba8e30400483045022100c0d2cd4608cbe6ce0f63f20d7722dcad7e9be41ad8ed31f43f2fdcc4333a6ffb02205e1ae53546914379fd6862b0198122990fe00ee4404e041f62e4a591becf7e980148304502210083758a4e1327df7e1687a326b649b34c6e11fc829a5b731816112c326e4c3a9102206f9c8c179996777e9728c1f3cd85d0281b6dfc43ac7705a3068498df62bc84640169522102cd47ae4cfb7b3fa202b272c0365a54b7f0a23bd2b6ca8b1368a122116f0e83c02103b10b9659bff7bbe5e9ff48e9d6bb5af50938456c42c93aea70959d1ec5b4fcc82103ebe4d67ce8be202ae3bdf0ba688ac1846ebc22f732b162bb39cb3d0d332d5a4753ae05004004027ce4117a674458e01d67702376021c738be0c74d476e66b52937886534178f058f80294c631b3f4a097711cefa7a7d0902a765ca29b58d81da9dff1101fd407615c1b68342394597ae1f0df854f4ea3e5c250603ed0b516183d98f58ce80c2b7f12b9bf5582b109ca937c81b72c56a5183b58e5a6f8f7fb45ebde13bf55f206820277ee6fe3842ebd91b94f016fab2b04cef0c2f5e5d19c8b21f78b7f05828aba0ac2057d6200a2e5727813bacb7f43f60e546750c9b587e6c9e393b6746a14ea456afba20caa61dca335e7984d2ace96359c2f2856b8b94ba3a0bb546b8aac1c986c7b600ba529c21c02ba212aa24f05f743fe6176f15f604c46b34314da2baba274c029c6ea4dfde9100000000');
  });

});
